<!DOCTYPE html>
<html>
<head>
  <title>The Entropic Archive</title>
  <style>
    body {
      background: black;
      color: white;
      font-family: monospace;
      padding: 2rem;
      margin: 0;
      overflow-x: hidden;
    }
    
    form {
      margin-bottom: 2rem;
      position: relative;
      z-index: 1;
      transition: all 1s ease;
    }
    
    form:hover {
      transform: perspective(500px) rotateX(10deg) scale(0.98);
      filter: blur(0.5px);
    }
    
    textarea {
      width: 100%;
      background: #111;
      color: #0f0;
      border: 1px solid #0e0808;
      padding: 1rem;
      font-family: monospace;
      resize: vertical;
      min-height: 100px;
    }
    
    button {
      margin-top: 0.5rem;
      padding: 0.5rem 1rem;
      background: #222;
      color: white;
      border: 1px solid #555;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    button:hover {
      background: #333;
    }
    
    .fragment {
      animation: flicker 1.2s infinite alternate;
      font-size: 1.2rem;
      margin: 1rem 0;
      position: relative;
      z-index: 1;
      white-space: pre-wrap; /* For spaghettification newlines */
    }
    
    @keyframes flicker {
      from { opacity: 1; }
      to { opacity: 0.5; transform: scale(1.01); }
    }
    
    #blackhole-canvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
      opacity: 0.7;
      width: 100%;
      height: 100%;
    }
    
    h1 {
      color: #4b79cf;
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
      z-index: 1;
      text-shadow: 0 0 10px rgba(75, 121, 207, 0.5);
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
  <canvas id="blackhole-canvas"></canvas>
  <h1>The Entropic Archive</h1>

  <form method="POST">
    {% csrf_token %}
    <textarea name="content" rows="3" placeholder="Submit your thoughts to the void..."></textarea><br>
    <button type="submit">Collapse into the Archive</button>
  </form>

  {% for submission in submissions %}
    <p class="fragment">{{ submission.fragments }}</p>
  {% endfor %}

  <script>
    // Initialize Three.js scene
    const canvas = document.getElementById('blackhole-canvas');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ 
      canvas, 
      alpha: true,
      antialias: true 
    });
    renderer.setSize(window.innerWidth, window.innerHeight);

    // Create black hole
    const geometry = new THREE.SphereGeometry(1, 64, 64);
    const material = new THREE.MeshBasicMaterial({ 
      color: 0x000000,
      transparent: true,
      opacity: 0.9
    });
    const blackHole = new THREE.Mesh(geometry, material);
    scene.add(blackHole);

    // Add glowing accretion disk
    const diskGeometry = new THREE.TorusGeometry(1.5, 0.3, 16, 100);
    const diskMaterial = new THREE.MeshBasicMaterial({ 
      color: 0x4b79cf,
      side: THREE.DoubleSide,
      transparent: true,
      opacity: 0.8
    });
    const accretionDisk = new THREE.Mesh(diskGeometry, diskMaterial);
    accretionDisk.rotation.x = Math.PI / 2;
    scene.add(accretionDisk);

    // Hawking radiation particles
    const particles = new THREE.Group();
    scene.add(particles);
    
    for (let i = 0; i < 100; i++) {
      const particle = new THREE.Mesh(
        new THREE.SphereGeometry(0.05, 8, 8),
        new THREE.MeshBasicMaterial({ color: 0x88ccff })
      );
      particle.position.set(
        Math.random() * 4 - 2,
        Math.random() * 4 - 2,
        Math.random() * 4 - 2
      );
      particles.add(particle);
    }

    // Position camera
    camera.position.z = 5;

    // Animation loop
    function animate() {
      requestAnimationFrame(animate);
      
      // Rotate black hole and disk
      blackHole.rotation.y += 0.005;
      accretionDisk.rotation.z += 0.02;
      
      // Animate particles (Hawking radiation)
      particles.children.forEach(p => {
        p.position.x += (Math.random() - 0.5) * 0.02;
        p.position.y += Math.random() * 0.03;
        p.position.z += (Math.random() - 0.5) * 0.01;
        if (p.position.y > 3) p.position.y = -3;
      });
      
      renderer.render(scene, camera);
    }
    animate();

    // Handle window resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>